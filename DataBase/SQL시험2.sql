USE naver_db;
DROP TABLE IF EXISTS emp_test;

CREATE TABLE emp_test
(EMPNO INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
 ENAME VARCHAR(10) NOT NULL,
 JOB   VARCHAR(9) NOT NULL,
 MGR   INT NOT NULL,
 HIREDATE DATE NOT NULL)
 COMMENT = '김양은';
 
SELECT * FROM emp_test;

DROP TABLE IF EXISTS FOOD_WAREHOUSE;
USE naver_db;
CREATE TABLE FOOD_WAREHOUSE
(WAREHOUSE_ID		VARCHAR(10) NOT NULL PRIMARY KEY,
 WAREHOUSE_NAME		VARCHAR(20)	NOT NULL,
 ADDRESS			VARCHAR(100) NULL,
 TLNO				VARCHAR(20)	NULL,
 FREEZER_YN			VARCHAR(1) NULL
);

INSERT INTO FOOD_WAREHOUSE VALUES ('WH0001','창고_경기1','경기도 안산시 상록구 용담로 141',031-152-1332,'Y');
INSERT INTO FOOD_WAREHOUSE VALUES ('WH0002','창고_충북1','충청북도 진천군 진천읍 씨제이로 110',043-623-9900,'Y');
INSERT INTO FOOD_WAREHOUSE VALUES ('WH0003','창고_경기2','경기도 이천시 마장면 덕평로 811',031-221-7241,NULL);
INSERT INTO FOOD_WAREHOUSE VALUES ('WH0004','창고_경기3','경기도 김포시 대곶면 율생중앙로205번길',031-671-1900,'N');
INSERT INTO FOOD_WAREHOUSE VALUES ('WH0005','창고_충남1','충청남도 천안시 동남구 광덕면 신덕리1길 9',041-876-5421,'Y');


SELECT WAREHOUSE_ID, WAREHOUSE_NAME, ADDRESS, 
   CASE
       WHEN FREEZER_YN IS NULL THEN 'N'
       ELSE FREEZER_YN
   END FREEZER_YN
FROM FOOD_WAREHOUSE
WHERE ADDRESS LIKE '경기도%'
ORDER BY WAREHOUSE_ID ASC;

SELECT WAREHOUSE_ID, WAREHOUSE_NAME, ADDRESS, COALESCE(FREEZER_YN, 'N') AS FREEZER_YN
FROM FOOD_WAREHOUSE
WHERE ADDRESS LIKE '%경기도%'
ORDER BY WAREHOUSE_ID ASC;


DROP TABLE IF EXISTS PATIENT;
USE naver_db;
CREATE TABLE PATIENT
(PT_NO		VARCHAR(10) NOT NULL PRIMARY KEY,
 PT_NAME		VARCHAR(20)	NOT NULL,
 GEND_CD			VARCHAR(1) NOT NULL,
 AGE			INT	NOT NULL,
 TLNO		VARCHAR(50) NULL
);

INSERT INTO PATIENT VALUES ('PT22000003','브라운','M',18,01031246641);
INSERT INTO PATIENT VALUES ('PT22000004','크롱','M',7,NULL);
INSERT INTO PATIENT VALUES ('PT22000006','뽀뽀','W',8,NULL);
INSERT INTO PATIENT VALUES ('PT22000009','한나','W',12,01032323117);
INSERT INTO PATIENT VALUES ('PT22000012','뿡뿡이','M',5,NULL);
INSERT INTO PATIENT VALUES ('PT22000013','크리스','M',30,01059341192);
INSERT INTO PATIENT VALUES ('PT22000014','토프','W',22,01039458213);
INSERT INTO PATIENT VALUES ('PT22000018','안나','W',11,NULL);
INSERT INTO PATIENT VALUES ('PT22000019','바라','W',10,01079068799);
INSERT INTO PATIENT VALUES ('PT22000021','릴로','W',33,01023290767
);


SELECT PT_NAME, PT_NO, GEND_CD, AGE,
   CASE
       WHEN TLNO IS NULL THEN 'NONE'
       ELSE TLNO
   END TLNO
FROM PATIENT
WHERE AGE <= 12 AND GEND_CD = 'W'
ORDER BY AGE DESC, PT_NAME ASC;

SELECT PT_NAME, PT_NO, GEND_CD, AGE, COALESCE(TLNO, 'NONE') AS TLNO
FROM PATIENT
WHERE AGE <= 12 AND GEND_CD = 'W'
ORDER BY AGE DESC, PT_NAME ASC;


DROP TABLE IF EXISTS FIRST_HALF;
USE naver_db;
CREATE TABLE  FIRST_HALF
(SHIPMENT_ID	INT NOT NULL,
 FLAVOR		VARCHAR(50)	NOT NULL,
 TOTAL_ORDER	INT NOT NULL,
 PRIMARY KEY(FLAVOR)
);
INSERT INTO FIRST_HALF VALUES (101, 'chocolate', 3200);
INSERT INTO FIRST_HALF VALUES (102, 'vanilla', 2800);
INSERT INTO FIRST_HALF VALUES (103, 'mint_chocolate', 1700);
INSERT INTO FIRST_HALF VALUES (104, 'caramel', 2600);
INSERT INTO FIRST_HALF VALUES (105, 'white_chocolate', 3100);
INSERT INTO FIRST_HALF VALUES (106, 'peach', 2450);
INSERT INTO FIRST_HALF VALUES (107, 'watermelon', 2150);
INSERT INTO FIRST_HALF VALUES (108, 'mango', 2900);
INSERT INTO FIRST_HALF VALUES (109, 'strawberry', 3100);
INSERT INTO FIRST_HALF VALUES (110, 'melon', 3150);
INSERT INTO FIRST_HALF VALUES (111, 'orange', 2900);
INSERT INTO FIRST_HALF VALUES (112, 'pineapple', 2900);

SELECT * FROM FIRST_HALF;

DROP TABLE IF EXISTS ICECREAM_INFO;
USE naver_db;
CREATE TABLE ICECREAM_INFO
(FLAVOR VARCHAR(50) NOT NULL PRIMARY KEY,
 INGREDEINT_TYPE VARCHAR(50) NOT NULL
 );

INSERT INTO ICECREAM_INFO VALUES ('chocolate','sugar_based');
INSERT INTO ICECREAM_INFO VALUES ('vanilla','sugar_based');
INSERT INTO ICECREAM_INFO VALUES ('mint_chocolate','sugar_based');
INSERT INTO ICECREAM_INFO VALUES ('caramel','sugar_based');
INSERT INTO ICECREAM_INFO VALUES ('white_chocolate','sugar_based');
INSERT INTO ICECREAM_INFO VALUES ('peach', 'fruit_based');
INSERT INTO ICECREAM_INFO VALUES ('watermelon','fruit_based');
INSERT INTO ICECREAM_INFO VALUES ('mango', 'fruit_based');
INSERT INTO ICECREAM_INFO VALUES ('strawberry', 'fruit_based');
INSERT INTO ICECREAM_INFO VALUES ('melon', 'fruit_based');
INSERT INTO ICECREAM_INFO VALUES ('orange', 'fruit_based');
INSERT INTO ICECREAM_INFO VALUES ('pineapple', 'fruit_based');

SELECT * FROM ICECREAM_INFO;

SELECT FH.FLAVOR, II.FLAVOR, FH.TOTAL_ORDER, II.INGREDEINT_TYPE
FROM FIRST_HALF FH
INNER JOIN ICECREAM_INFO II
ON FH.FLAVOR = II.FLAVOR
WHERE FH.TOTAL_ORDER > 3000 AND II.INGREDEINT_TYPE = 'fruit_based'
ORDER BY FH.TOTAL_ORDER DESC;


DROP TABLE IF EXISTS CAR_RENTAL_COMPANY_CAR;
USE naver_db;
CREATE TABLE CAR_RENTAL_COMPANY_CAR 
(CAR_ID INTEGER NOT NULL PRIMARY KEY,
 CAR_TYPE VARCHAR(255) NOT NULL,
 DAILY_FEE INTEGER NOT NULL,
 OPTIONS VARCHAR(255) NOT NULL
 );

INSERT INTO CAR_RENTAL_COMPANY_CAR VALUES (1, '세단', 16000, '가죽시트,열선시트,후방카메라');
INSERT INTO CAR_RENTAL_COMPANY_CAR VALUES (2, 'SUV', 14000, '스마트키,네비게이션,열선시트');
INSERT INTO CAR_RENTAL_COMPANY_CAR VALUES (3, 'SUV', 22000, '주차감지센서,후방카메라,네비게이션'
);

SELECT * FROM CAR_RENTAL_COMPANY_CAR;

SELECT CAR_ID, CAR_TYPE, DAILY_FEE, OPTIONS
FROM CAR_RENTAL_COMPANY_CAR
WHERE OPTIONS LIKE '%네비게이션%'
ORDER BY CAR_ID DESC;
